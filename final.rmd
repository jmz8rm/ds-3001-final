---
title: "Final project"
author: 
- "Justin Zhang"
- "Cato Zhong"
- "Aaron Lin"
date: "May 1, 2023"
output:
  html_document:
    toc: TRUE
    theme: cosmo
    toc_float: TRUE
    code_folding: hide
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(caret)
library(rpart)
library(rpart.plot)
library(randomForest)
library(ROCR)
library(ggplot2)
library(MLmetrics)
library(mltools)
```
<!-- Phase 1: Idea Development --> 
# Question:
## Background
Bike shares are a new type of bike rental that has been fully automated, from membership to rental and return. These systems allow users to easily rent bikes from one location and return them to other locations around the city.

We chose to focus on the Capital Bikeshare located in Washington, DC and look at the hourly data associated with the bikeshare.

We picked this data-set due in part due to the size, with 17,000+ rows available and a good mix of categorical and continuous data. The bikeshare data can also tell us about the traffic, environmental, and health issues in the city so it is an interesting data set to look at.

Our group wanted to know if we could accurately predict the number of bikes rented out based on a number of factors, including weather, season, time of day, and type of day (weekday, workday, holiday).

Other research published using this data set:
https://link.springer.com/article/10.1007/s13748-013-0040-3


<!-- Phase 2: Data Prep & Problem Exploration --> 
## Exploratory analysis
```{r}

# preprocessing
bike <- read.csv("bike-hour.csv")
rownames(bike) <- bike$instant


str(bike)
bike <- bike %>% 
  select(-c(instant, dteday, casual, registered, yr)) %>% 
  mutate_at(c("season", "yr", "mnth", "hr", "holiday", "weekday", "workingday", "weathersit"), as.factor)
str(bike)

view(bike)


fivenum(bike$cnt)
boxplot(bike$cnt)
hist(bike$cnt, col = 'red')


bike_tbl <- bike %>% group_by(hr) %>% 
  summarise(sum=sum(cnt),
            .groups = 'drop')

ggplot(bike_tbl, aes(x = hr, y = sum)) +
    geom_bar(stat = 'identity')
```
1 Bike is by far the most common amount of bikes rented out at one time. The data set does not include data where there were no bikes checked out, which is why the morning hours have a few less data points than waking hours. The rest of the hours have uniformly even counts, with 6AM - 11PM all having between 725 and 730 data points. 


=======

<!-- Phase 3: Solution Development --> 
>>>>>>> 3f096e5ce830b23befea1b61ec1d5a4587ebf36a
## Methods
```{r}

# split data
set.seed(2023)
train_tunetest_index <- createDataPartition(bike$cnt, p=0.7, list=FALSE)
train <- bike[train_tunetest_index,]
tunetest <- bike[-train_tunetest_index,]
tune_test_index <- createDataPartition(tunetest$cnt, p=0.5, list=FALSE)
tune <- tunetest[tune_test_index,]
test <- tunetest[-tune_test_index,]

hist(train$cnt)
hist(tune$cnt)
hist(test$cnt)

```

```{r}

# training
train_x <- train %>% select(-cnt)
train_y <- train$cnt
rf <- randomForest(train_x, train_y)

```

```{r}
# evaluate/tune
```

```{r}
# tune
```
## Evaluation
## Fairness assessment

<!-- Phase 4: Solution Deployment --> 
## Conclusion
## Future work